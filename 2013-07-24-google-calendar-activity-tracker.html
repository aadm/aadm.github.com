<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>google calendar activity tracker - aadm</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="http://aadm.github.io/favicon.png" rel="icon">

<link rel="canonical" href="http://aadm.github.io/2013-07-24-google-calendar-activity-tracker.html">

        <meta name="author" content="Alessandro Amato del Monte" />
        <meta name="keywords" content="tech,cycling,apple" />
        <meta name="description" content="It’s been years since I started using Google Calendar to keep track my sports activities. I guess there are countless apps to do this but all I needed is something basic that I can access from anywhere. Since I already have synced my iPhone with Google Calendar, I can basically enter data from wherever I am, even if there ..." />

        <meta property="og:site_name" content="aadm" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="google calendar activity tracker"/>
        <meta property="og:url" content="http://aadm.github.io/2013-07-24-google-calendar-activity-tracker.html"/>
        <meta property="og:description" content="It’s been years since I started using Google Calendar to keep track my sports activities. I guess there are countless apps to do this but all I needed is something basic that I can access from anywhere. Since I already have synced my iPhone with Google Calendar, I can basically enter data from wherever I am, even if there ..."/>
        <meta property="article:published_time" content="2013-07-24" />
            <meta property="article:section" content="misc" />
            <meta property="article:tag" content="tech" />
            <meta property="article:tag" content="cycling" />
            <meta property="article:tag" content="apple" />
            <meta property="article:author" content="Alessandro Amato del Monte" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://aadm.github.io/theme/css/bootstrap.journal.min.css" type="text/css"/>
    <link href="http://aadm.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://aadm.github.io/theme/css/pygments/tango.css" rel="stylesheet">
        <link href="http://aadm.github.io/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://aadm.github.io/theme/css/style.css" type="text/css"/>
        <link href="http://aadm.github.io/static/custom.css" rel="stylesheet">

        <link href="http://aadm.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="aadm ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://aadm.github.io/" class="navbar-brand">
aadm            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="blog_index.html">blog</a></li>
                    <li><a href="pages/projects.html">projects</a></li>
                    <li><a href="pages/about.html">about</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <!-- <li><a href="http://aadm.github.io/blog_index.html"><i class="fa fa-th-list"></i><span class="icon-label">blog</span></a></li> -->
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://aadm.github.io/2013-07-24-google-calendar-activity-tracker.html"
                       rel="bookmark"
                       title="Permalink to google calendar activity tracker">
                        google calendar activity&nbsp;tracker
                    </a>
                </h1>
            </header>
            <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-07-24T00:00:00+02:00"> 24/Jul/2013</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="http://aadm.github.io/tag/tech.html">tech</a>
        /
	<a href="http://aadm.github.io/tag/cycling.html">cycling</a>
        /
	<a href="http://aadm.github.io/tag/apple.html">apple</a>
    
</footer><!-- /.post-info -->            </div>
            <div class="entry-content">
                <p>It&#8217;s been years since I started using Google Calendar to keep track my sports activities. I guess there are countless apps to do this but all I needed is something basic that I can access from anywhere. Since I already have synced my iPhone with Google Calendar, I can basically enter data from wherever I am, even if there is no internet connection, and then have it synced back to my main repository on Google servers as soon as I&#8217;m back&nbsp;online.</p>
<p>So what I did is a little Python script that gathers all this data and spits out a few statistics and&nbsp;graphs.</p>
<p>First however I need to explain what are my conventions to enter my activities in Google Calendar. I have four main categories: running, biking, swimming and &#8220;other&#8221; (which includes things I used to do but don&#8217;t do anymore or other occasional outdoor&nbsp;activities).</p>
<p>Basically I enter in my calendar an event that begins with &#8220;B&#8221; for biking, &#8220;S&#8221; for swimming, &#8220;R&#8221; for running. All the other activities that I enter are classified in the &#8220;other&#8221; category. Now I use a separate calendar to enter all of these items (aptly named &#8220;Sport&#8221;) &#8212; and I suggest you do the same if you also use Google Calendar for other purposes. In the script below however I have set the calendar name to the default, so you may want to change that name using the calendar <span class="caps">ID</span><sup id="fnref:nota-calendar-id"><a class="footnote-ref" href="#fn:nota-calendar-id" rel="footnote">1</a></sup>.</p>
<p>These are two examples of the yearly&nbsp;reports:</p>
<p><img alt="" src="https://dl.dropboxusercontent.com/u/179731/sport_gcal_2010.png" /></p>
<p><img alt="" src="https://dl.dropboxusercontent.com/u/179731/sport_gcal_2012.png" /></p>
<p>And this is what a typical month looks like in my Google Calendar (there is some differences in the codes that I use because for example I enter &#8220;C&#8221; for <em>corsa</em>, which is the italian for running; likewise I have two separate categories for biking, &#8220;B&#8221; for road biking and &#8220;<span class="caps">MTB</span>&#8221; for mountain biking; in the script however I have simplified the categories and only included one). You can also notice how I write additional info like duration and length whenever possible; someday I&#8217;ll get around to do a Python script also to collect and make stats on this&nbsp;information.</p>
<p><img alt="" src="https://dl.dropboxusercontent.com/u/179731/google_calendar_esempio.png" /></p>
<p>Finally, here&#8217;s the script (please read the notes&nbsp;below):</p>
<p>{% highlight python&nbsp;%}</p>
<p>from pylab import *
import getpass
import gdata.calendar.service
import gdata.service
import&nbsp;gdata.calendar</p>
<p>def main():
    username = raw_input(&#8220;Enter your username: &#8220;)
    password = getpass.getpass(&#8220;Enter your password: &#8220;)
    inizio = raw_input(&#8220;From year: &#8220;)
    fine   = raw_input(&#8220;To year: &#8220;)&nbsp;intervallo=range(int(inizio),int(fine)+1)</p>
<div class="highlight"><pre>calendar_service = gdata.calendar.service.CalendarService(username,password,&quot;prova-cal&quot;)
try:
    calendar_service.ProgrammaticLogin()
except gdata.service.BadAuthentication, e:
    print &quot;Authentication error logging in: %s&quot; % e
    return
except Exception, e:
    print &quot;Error Logging in: %s&quot; % e
    return

for anno in intervallo:
    start_date=str(anno)+&#39;-01-01&#39;
    end_date=str(anno)+&#39;-12-31&#39;
    calname=&#39;default&#39;
    lista=DateRangeQuery(calendar_service,start_date,end_date,calname)
    lista=sorted(lista)

    corsa=bici=mtb=nuoto=altro=0
    for x in lista:
        if x[11:13] == &#39;R &#39;:
            corsa+=1
        elif x[11:13] == &#39;B &#39;:
            bici += 1
        elif x[11:13] == &#39;S &#39;:
            nuoto += 1
        else:
            altro += 1
    totale=float(len(lista))
    print &#39;---&gt; YEAR &#39;+str(anno)
    print &#39;running:  %3d (%2.0f%%)&#39; % (corsa, (corsa/totale)*100)
    print &#39;swimming: %3d (%2.0f%%)&#39; % (nuoto, (nuoto/totale)*100)
    print &#39;biking:   %3d (%2.0f%%)&#39; % (bici,  (bici/totale)*100)
    print &#39;other:    %3d (%2.0f%%)&#39; % (altro, (altro/totale)*100)

    nn=[corsa,bici,nuoto,altro]
    mycolors=[&#39;green&#39;,   &#39;red&#39;,    &#39;cyan&#39;,     &#39;white&#39;]
    mylabels=[&#39;RUNNING&#39;, &#39;BIKING&#39;, &#39;SWIMMING&#39;, &#39;OTHER&#39;]

    figure(figsize=(5,5))
    axes([0.1, 0.1, 0.8, 0.8])
    pie(nn,autopct=&#39;%1.0f%%&#39;,labels=mylabels,colors=mycolors)
    title(start_date[0:4]+&#39; (events=&#39;+str(int(totale))+&#39;)&#39;)
    show(block=False)
</pre></div>


<p>def DateRangeQuery(calendar_service, start_date, end_date, calname):
    aaa=[]
    query = gdata.calendar.service.CalendarEventQuery(calname, &#8216;private&#8217;, &#8216;full&#8217;)
    query.start_min = start_date
    query.start_max = end_date
    query.max_results=5000
    feed = calendar_service.CalendarQuery(query)
    for i, event in enumerate(feed.entry):
        name=event.title.text
        for a_when in event.when:
            time=a_when.start_time
        aaa.append(time[:10]+&#8217;,&#8217;+name.upper())
    return&nbsp;aaa</p>
<p _="%" endhighlight="endhighlight">if <strong>name</strong> == &#8220;<strong>main</strong>&#8220;:
    out=main()&nbsp;show()</p>
<p>A few notes about this&nbsp;script:</p>
<ul>
<li>This is tested on Mac <span class="caps">OS</span> X using the latest <a href="https://www.enthought.com/products/canopy/">Canopy</a>&nbsp;installation. </li>
<li>You need to have the <a href="https://code.google.com/p/gdata-python-client/">gdata Python library</a> installed. There is a way to avoid importing the library altogether<sup id="fnref:nota-install-gdata"><a class="footnote-ref" href="#fn:nota-install-gdata" rel="footnote">2</a></sup>. What you need to do is just to make the <code>gdata</code> and <code>atom</code> subdirectories that you find below <code>src</code> after unpacking the tar.gz available in the directory where you run the script. By the way, I have used <code>gdata-2.0.18.tar.gz</code> which is the latest version at the time of&nbsp;writing.</li>
<li>Another way to avoid installing gdata but keeping things a bit more organized is to keep the gdata folder stored somewhere and then add its path by inserting these two lines at the&nbsp;beginning:</li>
</ul>
<p _="%" endhighlight="endhighlight">{% highlight python %}
import sys
sys.path.append(&#8220;~/Documents/_PROG/<span class="caps">PYTHON</span>/gdata-2.0.18/src/gdata&#8221;)</p>
<ul>
<li>For some reasons however the above method only works if I run the script from within Canopy and not from Terminal. I have no idea why and I have no intention to spend any more time investigating this little&nbsp;bugger.</li>
<li>This script works from the terminal by typing <code>$ python gcal_sport.py</code> or whatever you want to call this script. To make the plots persistent I had to add the <code>show(block=False)</code> in the main function and <code>show()</code> at the end of the script. If you run it under iPython (Canopy for example uses iPython) then you can get rid of the <code>block=False</code> option and delete the last <code>show()</code> line.</li>
<li>I&#8217;m not a huge nerd but I can make this stuff work. I wanted to share this script because I find it useful and maybe some other poor devil will find some use for it. The point is that I have no intention nor time to help Windows users, or people that don&#8217;t even know what Python is. For all of you sane people please go see my <a href="http://aadm.github.io/tags.html#weekly%20snaps-ref">photographs</a>&nbsp;instead.</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:nota-calendar-id">
<p>First you have to get the calendar <span class="caps">ID</span>. If you go into your calendar and click on the down arrow icon next to the name you will see an option for Calendar Settings. Select that menu item. Near the bottom you will see Calendar Address. It will take a moment to find the Calendar <span class="caps">ID</span> and it will look something like <code>o4g3921hdiaq5p8kdat2l4vgis@group.calendar.google.com</code>. (from <a href="http://stackoverflow.com/questions/555468/how-do-i-insert-into-non-default-google-calendar-using-zend-php">http://stackoverflow.com/questions/555468/how-do-i-insert-into-non-default-google-calendar-using-zend-php</a>).&#160;<a class="footnote-backref" href="#fnref:nota-calendar-id" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:nota-install-gdata">
<p>I had to find this workaround because in Canopy Express (the free distribution) you can not install through the package manager some less used libraries such as gdata.&#160;<a class="footnote-backref" href="#fnref:nota-install-gdata" rev="footnote" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

    <style type="text/css">
    #navcontainer ul
    {
    margin: 0;
    margin-top: 40px;
    padding: 0;
    list-style-type: none;
    text-align: center;
    }
    #navcontainer ul li { display: inline; }
    #navcontainer ul li a { padding: 1em 3em; }
    </style>

    <div id="navcontainer">
    <ul id="navlist">
        <li><a href="http://aadm.github.io/2013-06-19-weekly-snaps-16.html"><i class="fa fa-angle-left"></i> PREVIOUS</a></li>
        <li><a href="http://aadm.github.io/2013-07-25-on-sloppy-street-photographers.html">NEXT <i class="fa fa-angle-right"></i></a></li>
    </div>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2005-2016 Alessandro Amato del Monte              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution 4.0 International License</a>
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-angle-up"></i> <a href="#">TOP</a></p></div>
      </div>
   </div>
</footer>
<script src="http://aadm.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://aadm.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://aadm.github.io/theme/js/respond.min.js"></script>

    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-32354823-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

</body>
</html>